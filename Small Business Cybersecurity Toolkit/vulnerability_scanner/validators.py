import re
import socket

import ipaddress

def validate_ip(ip):
    """Validate if the input is a valid IPv4 address."""
    try:
        ipaddress.IPv4Address(ip)
        return True
    except ipaddress.AddressValueError:
        return False


def validate_hostname(hostname):
    """Validate the given hostname."""
    hostname_regex = r'^([a-zA-Z0-9][-a-zA-Z0-9]*\.)+[a-zA-Z]{2,}$'
    return bool(re.match(hostname_regex, hostname))

def resolve_hostname(hostname):
    """Resolve a hostname to its IP address."""
    try:
        return socket.gethostbyname(hostname)
    except socket.error:
        print(f"Could not resolve hostname: {hostname}")
        return None
    
def validate_ip_range(ip_or_range):
    """Validate a single IP or an IP range."""
    try:
        # Check if it's a single IP
        ipaddress.ip_address(ip_or_range)
        return True
    except ValueError:
        try:
            # Check if it's a valid IP network range
            ipaddress.ip_network(ip_or_range, strict=False)
            return True
        except ValueError:
            return False