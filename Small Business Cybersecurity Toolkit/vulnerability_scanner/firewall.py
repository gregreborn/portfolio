import os
import platform

def block_ip(ip):
    """Block a specific IP address using firewall rules."""
    os_type = platform.system()
    if os_type == "Windows":
        # Windows Firewall rule
        command = f'netsh advfirewall firewall add rule name="Block {ip}" dir=in action=block remoteip={ip}'
    elif os_type == "Linux":
        # iptables rule for Linux
        command = f'sudo iptables -A INPUT -s {ip} -j DROP'
    else:
        raise NotImplementedError("Unsupported operating system.")

    print(f"Executing command: {command}")
    os.system(command)

def allow_ip(ip):
    """Allow a specific IP address using firewall rules."""
    os_type = platform.system()
    if os_type == "Windows":
        # Windows Firewall rule
        command = f'netsh advfirewall firewall add rule name="Allow {ip}" dir=in action=allow remoteip={ip}'
    elif os_type == "Linux":
        # iptables rule for Linux
        command = f'sudo iptables -A INPUT -s {ip} -j ACCEPT'
    else:
        raise NotImplementedError("Unsupported operating system.")

    print(f"Executing command: {command}")
    os.system(command)
